create or replace function getMyRecords(in request_user_id int)
	returns table(
		studentNameOut varchar,
		studentSurnameOut varchar,
		activityOut varchar,
		pointsOut int,
		dateOut timestamptz
	)
language plpgsql
as $$

declare
	row record;
	
	studentName varchar;
	studentSurname varchar;
	activity varchar;
	pnts int;
begin
	return query 
	FOR row IN( select to_student,score_type,record.date from record where from_user=request_user_id)
	
	LOOP
		
		select "name", surname into studentName, studentSurname from student where id=row.to_student;
		studentNameOut:=studentName;
		studentSurnameOut:=studentSurname;
		
		select "action", points into activity, pnts from score where id=row.score_type;
		activityOut:=activity;
		pointsOut:=pnts;
		dateOut:=row.date;
		return next;
	END LOOP;
	
end;
$$